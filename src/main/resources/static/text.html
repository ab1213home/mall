<!--
  ~ Copyright (c) 2024 Jiang RongJun
  ~ Jiang Mall is licensed under Mulan PSL v2.
  ~ You can use this software according to the terms and conditions of the Mulan
  ~ PSL v2.
  ~ You may obtain a copy of Mulan PSL v2 at:
  ~          http://license.coscl.org.cn/MulanPSL2
  ~ THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY
  ~ KIND, EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
  ~ NON-INFRINGEMENT, MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  ~ See the Mulan PSL v2 for more details.
  -->

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Quill Editor Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
    <link href="/public/quill-2.0.2-dist/dist/quill.snow.css" rel="stylesheet">
    <link href="/public/quill-image-uploader-dist/quill.imageUploader.min.css" rel="stylesheet">
<!--    <link href="//cdn.staticfile.org/quill/2.0.2/quill.bubble.css" rel="stylesheet">-->
<!--    <link href="//cdn.staticfile.org/quill/2.0.2/quill.core.css" rel="stylesheet">-->
</head>
<body>

<!-- Create the editor container -->
<div id="editor">
  <p>Hello World!</p>
  <p>Some initial <strong>bold</strong> text</p>
  <p><br /></p>
</div>

<script src="/public/quill-2.0.2-dist/dist/quill.js"></script>
<script src="/public/quill-image-uploader-dist/quill.imageUploader.min.js"></script>
<script src="/public/quill-image-uploader-dist/demo.min.js"></script>
<script src="/public/fingerprintjs-4.5.1-dist/fp.min.js"></script>
<script type="module">
    const toolbarOptions = [
        ['bold', 'italic', 'underline', 'strike'], // 加粗 斜体 下划线 删除线
        ['blockquote', 'code-block'], // 引用  代码块
        [{ header: 1 }, { header: 2 }], // 1、2 级标题
        [{ list: 'ordered' }, { list: 'bullet' }], // 有序、无序列表
        [{ script: 'sub' }, { script: 'super' }], // 上标/下标
        [{ indent: '-1' }, { indent: '+1' }], // 缩进
        [{ direction: 'rtl' }], // 文本方向
        [{ 'size': ['small', false, 'large', 'huge'] }],  // 字体大小
        [{ header: [1, 2, 3, 4, 5, 6, false] }], // 标题
        [{ color: [] }, { background: [] }], // 字体颜色、字体背景颜色
        [{ font: [] }], // 字体种类
        [{ align: [] }], // 对齐方式
        ['clean'], // 清除文本格式
        ['link', 'image'], // 链接、图片
    ];

    async function uploadFileAPI(file) {
        const formData = new FormData();
        formData.append('file', file);
        $.ajax({
            url: '/common/uploadFile',
            type: 'post',
            data:formData,
            contentType: false,
            processData: false,
            success: function (res){
                if (res.code == 200){
                    return res.data
                }else {
                    return false
                }
            }
        });
    }

    const quill = new Quill('#editor', {
        modules: {
            imageUploader: {
                upload: async (file) => {
                    return await uploadFileAPI({file}) // 此处替换为接口返回的文件路径
                }
            },
            toolbar: toolbarOptions
        },
        theme: 'snow'
    });
    async function getFingerprint() {
        // 加载FingerprintJS库，这是一个异步操作，需要使用await等待加载完成
        const fpPromise = await FingerprintJS.load();
        // 调用get()方法获取设备的指纹信息，这是一个异步操作，需要使用await等待获取完成
        const result = await fpPromise.get();
        // 获取到指纹信息后，可以将其保存到数据库或者本地存储中，以便后续使用
        return result.visitorId
    }
    (async () => {
        const fingerprint = await getFingerprint();
        console.log(fingerprint); // 打印指纹信息
    })();

</script>
<!--<script src="//cdn.staticfile.org/quill/2.0.2/quill.min.js"></script>-->
<!--<script src="//cdn.staticfile.org/quill/2.0.2/quill.core.js"></script>-->

</body>
</html>
